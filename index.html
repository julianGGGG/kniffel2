<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kniffel Score Sheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 5px;
            margin: 0;
            box-sizing: border-box;
            font-size: 0.9em;
            overflow: hidden; /* Verhindert das Scrollen */
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #000;
            text-align: center;
            padding: 2px;
            width: 33.33%;
        }
        .category {
            text-align: left;
            font-size: 0.9em;
            text-transform: capitalize;
        }
        input[type=number], select, input[type=text], input[type=checkbox] {
            box-sizing: border-box;
            font-size: 0.9em;
        }
        select {
            text-align: center;
            text-align-last: center; /* For Firefox */
        }
        .result {
            font-weight: bold;
            text-align: center;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 34px;
            height: 20px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 12px;
            width: 12px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(14px);
        }
        .slider.round {
            border-radius: 34px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
        @media (max-width: 600px) {
            table, thead, tbody, th, td, tr {
                display: block;
            }
            thead tr {
                display: none;
            }
            tr {
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                margin-bottom: 0;
                border: 1px solid #000;
                padding: 2px;
                background-color: #f9f9f9;
            }
            td {
                border: none;
                flex: 1;
                padding: 2px;
                text-align: left;
            }
            .category {
                flex: 1;
                font-weight: bold;
            }
            .checkbox-wrapper {
                display: flex;
                align-items: center;
                flex: 1;
            }
            select, input[type=number] {
                flex: 1;
            }
            .result, input[type=text] {
                text-align: center;
                font-weight: bold;
            }
        }
    </style>
</head>
<body>
    <table id="score-table">
        <tbody>
            <tr>
                <td>
                    <select id="player-count" style="width: 100%; box-sizing: border-box;">
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </td>
                <td id="player1-name-cell">
                    <div class="checkbox-wrapper">
                        <input type="text" id="player1-name" value="Spieler 1" class="result" style="width: 100%; box-sizing: border-box;">
                    </div>
                </td>
                <td id="player2-name-cell">
                    <div class="checkbox-wrapper">
                        <input type="text" id="player2-name" value="Spieler 2" class="result" style="width: 100%; box-sizing: border-box;">
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">1er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-1er-hide">
                        <select id="player1-1er">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-1er-hide">
                        <select id="player2-1er">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">2er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-2er-hide">
                        <select id="player1-2er">
                            <option value="0">0</option>
                            <option value="2">2</option>
                            <option value="4">4</option>
                            <option value="6">6</option>
                            <option value="8">8</option>
                            <option value="10">10</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-2er-hide">
                        <select id="player2-2er">
                            <option value="0">0</option>
                            <option value="2">2</option>
                            <option value="4">4</option>
                            <option value="6">6</option>
                            <option value="8">8</option>
                            <option value="10">10</option>
                            <option value="12">12</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">3er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-3er-hide">
                        <select id="player1-3er">
                            <option value="0">0</option>
                            <option value="3">3</option>
                            <option value="6">6</option>
                            <option value="9">9</option>
                            <option value="12">12</option>
                            <option value="15">15</option>
                            <option value="18">18</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-3er-hide">
                        <select id="player2-3er">
                            <option value="0">0</option>
                            <option value="3">3</option>
                            <option value="6">6</option>
                            <option value="9">9</option>
                            <option value="12">12</option>
                            <option value="15">15</option>
                            <option value="18">18</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">4er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-4er-hide">
                        <select id="player1-4er">
                            <option value="0">0</option>
                            <option value="4">4</option>
                            <option value="8">8</option>
                            <option value="12">12</option>
                            <option value="16">16</option>
                            <option value="20">20</option>
                            <option value="24">24</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-4er-hide">
                        <select id="player2-4er">
                            <option value="0">0</option>
                            <option value="4">4</option>
                            <option value="8">8</option>
                            <option value="12">12</option>
                            <option value="16">16</option>
                            <option value="20">20</option>
                            <option value="24">24</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">5er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-5er-hide">
                        <select id="player1-5er">
                            <option value="0">0</option>
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="25">25</option>
                            <option value="30">30</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-5er-hide">
                        <select id="player2-5er">
                            <option value="0">0</option>
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                            <option value="25">25</option>
                            <option value="30">30</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">6er</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-6er-hide">
                        <select id="player1-6er">
                            <option value="0">0</option>
                            <option value="6">6</option>
                            <option value="12">12</option>
                            <option value="18">18</option>
                            <option value="24">24</option>
                            <option value="30">30</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-6er-hide">
                        <select id="player2-6er">
                            <option value="0">0</option>
                            <option value="6">6</option>
                            <option value="12">12</option>
                            <option value="18">18</option>
                            <option value="24">24</option>
                            <option value="30">30</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Gesamt</td>
                <td class="result"><span id="player1-gesamt">0</span></td>
                <td class="result"><span id="player2-gesamt">0</span></td>
            </tr>
            <tr>
                <td class="category">Bonus</td>
                <td class="result"><span id="player1-bonus">0</span></td>
                <td class="result"><span id="player2-bonus">0</span></td>
            </tr>
            <tr>
                <td class="category">Gesamt Oben</td>
                <td class="result"><span id="player1-gesamt-oben">0</span></td>
                <td class="result"><span id="player2-gesamt-oben">0</span></td>
            </tr>
            <tr>
                <td class="category">Dreierpasch</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-dreierpasch-hide">
                        <select id="player1-dreierpasch">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-dreierpasch-hide">
                        <select id="player2-dreierpasch">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Viererpasch</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-viererpasch-hide">
                        <select id="player1-viererpasch">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-viererpasch-hide">
                        <select id="player2-viererpasch">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Full House</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-fullhouse-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player1-fullhouse" name="player1-fullhouse" value="25">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-fullhouse-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player2-fullhouse" name="player2-fullhouse" value="25">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Kl. Straße</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-kleinestr-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player1-kleinestr" name="player1-kleinestr" value="30">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-kleinestr-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player2-kleinestr" name="player2-kleinestr" value="30">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Gr. Straße</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-grossestr-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player1-grossestr" name="player1-grossestr" value="40">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-grossestr-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player2-grossestr" name="player2-grossestr" value="40">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Kniffel</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-kniffel-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player1-kniffel" name="player1-kniffel" value="50">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-kniffel-hide">
                        <label class="switch" style="margin: 0 auto;">
                            <input type="checkbox" id="player2-kniffel" name="player2-kniffel" value="50">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Chance</td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player1-chance-hide">
                        <select id="player1-chance">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
                <td>
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="player2-chance-hide">
                        <select id="player2-chance">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                            <option value="36">36</option>
                        </select>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="category">Gesamt Unten</td>
                <td class="result"><span id="player1-gesamt-unten">0</span></td>
                <td class="result"><span id="player2-gesamt-unten">0</span></td>
            </tr>
            <tr>
                <td class="category">Gesamt Oben</td>
                <td class="result"><span id="player1-gesamt-oben-2">0</span></td>
                <td class="result"><span id="player2-gesamt-oben-2">0</span></td>
            </tr>
            <tr>
                <td class="category">Endsumme</td>
                <td class="result"><span id="player1-endsumme">0</span></td>
                <td class="result"><span id="player2-endsumme">0</span></td>
            </tr>
        </tbody>
    </table>
    <script>
        // Function to toggle visibility of elements and exclude from calculation
        function toggleVisibilityAndCalculation(checkbox, element) {
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    element.style.display = 'none';
                    element.dataset.ignore = 'true';
                } else {
                    element.style.display = 'block';
                    element.dataset.ignore = 'false';
                }
                calculateTotals();
            });
        }

        // Function to calculate totals
        function calculateTotals() {
            const playerCount = parseInt(document.getElementById('player-count').value, 10);
            const players = Array.from({ length: playerCount }, (_, i) => `player${i + 1}`);
            const upperCategories = ['1er', '2er', '3er', '4er', '5er', '6er'];
            const lowerCategories = ['dreierpasch', 'viererpasch', 'fullhouse', 'kleinestr', 'grossestr', 'kniffel', 'chance'];
            const upperSectionBonus = 63;
            const upperSectionBonusPoints = 35;

            players.forEach(player => {
                let upperTotal = 0;
                let lowerTotal = 0;

                // Calculate upper section total
                upperCategories.forEach(category => {
                    const element = document.getElementById(`${player}-${category}`);
                    if (element.dataset.ignore !== 'true') {
                        upperTotal += Number(element.value) || 0;
                    }
                });

                // Calculate bonus
                let bonus = upperTotal >= upperSectionBonus ? upperSectionBonusPoints : 0;
                document.getElementById(`${player}-bonus`).textContent = bonus;
                document.getElementById(`${player}-gesamt-oben`).textContent = upperTotal + bonus;

                // Calculate lower section total
                lowerCategories.forEach(category => {
                    const element = document.getElementById(`${player}-${category}`);
                    if (element && element.dataset.ignore !== 'true') {
                        if (category === 'fullhouse' || category === 'kleinestr' || category === 'grossestr' || category === 'kniffel') {
                            lowerTotal += element.checked ? Number(element.value) : 0;
                        } else {
                            lowerTotal += Number(element.value) || 0;
                        }
                    }
                });

                // Set totals
                document.getElementById(`${player}-gesamt`).textContent = upperTotal;
                document.getElementById(`${player}-gesamt-unten`).textContent = lowerTotal;
                document.getElementById(`${player}-gesamt-oben-2`).textContent = upperTotal + bonus;
                document.getElementById(`${player}-endsumme`).textContent = upperTotal + bonus + lowerTotal;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Add toggle visibility and calculation functionality for each row
            const rows = [
                '1er', '2er', '3er', '4er', '5er', '6er', 
                'dreierpasch', 'viererpasch', 'fullhouse', 'kleinestr', 
                'grossestr', 'kniffel', 'chance', 'gesamt-unten', 
                'gesamt-oben-2', 'endsumme'
            ];

            function updateTable() {
                const playerCount = parseInt(document.getElementById('player-count').value, 10);
                const table = document.getElementById('score-table');
                const headerRow = table.rows[0];

                // Remove all player columns
                while (headerRow.cells.length > 1) {
                    headerRow.deleteCell(1);
                }

                // Add the required number of player columns
                for (let i = 1; i <= playerCount; i++) {
                    headerRow.insertAdjacentHTML('beforeend', createPlayerColumn(i));
                }

                // Adjust table width for mobile view
                if (playerCount > 4) {
                    table.style.width = 'auto';
                } else {
                    table.style.width = '100%';
                }

                // Re-generate all other rows (except header)
                const categories = [
                    '1er', '2er', '3er', '4er', '5er', '6er',
                    'dreierpasch', 'viererpasch', 'fullhouse', 'kleinestr', 
                    'grossestr', 'kniffel', 'chance'
                ];

                // Clear existing rows
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }

                // Add rows for each category
                categories.forEach(category => {
                    const row = document.createElement('tr');
                    row.innerHTML = `<td class="category">${category}</td>`;
                    for (let i = 1; i <= playerCount; i++) {
                        row.insertAdjacentHTML('beforeend', `
                            <td>
                                <div class="checkbox-wrapper">
                                    <input type="checkbox" id="${player}-hide">
                                    <select id="${player}-${category}">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                    </select>
                                </div>
                            </td>
                        `);
                    }
                    table.tBodies[0].appendChild(row);
                });

                // Add the total, bonus, and other summary rows
                const summaryRows = [
                    'Gesamt', 'Bonus', 'Gesamt Oben', 'Gesamt Unten', 'Gesamt Oben', 'Endsumme'
                ];
                summaryRows.forEach(row => {
                    const summaryRow = document.createElement('tr');
                    summaryRow.innerHTML = `<td class="category">${row}</td>`;
                    for (let i = 1; i <= playerCount; i++) {
                        summaryRow.insertAdjacentHTML('beforeend', `<td class="result"><span id="player${i}-${row.toLowerCase().replace(' ', '-')}">0</span></td>`);
                    }
                    table.tBodies[0].appendChild(summaryRow);
                });

                calculateTotals();
            }

            playerCountInput.addEventListener('change', updateTable);
            updateTable();

            rows.forEach(row => {
                const players = Array.from({ length: 4 }, (_, i) => `player${i + 1}`);
                players.forEach(player => {
                    const checkbox = document.getElementById(`${player}-${row}-hide`);
                    const element = document.getElementById(`${player}-${row}`);
                    if (checkbox && element) {
                        toggleVisibilityAndCalculation(checkbox, element);
                    }
                });
            });

            // Calculate totals initially
            calculateTotals();

            // Recalculate totals on input change
            document.addEventListener('input', calculateTotals);
        });

        function createPlayerColumn(playerNumber) {
            return `
                <td id="player${playerNumber}-name-cell">
                    <div class="checkbox-wrapper">
                        <input type="text" id="player${playerNumber}-name" value="Spieler ${playerNumber}" class="result" style="width: 100%; box-sizing: border-box;">
                    </div>
                </td>`;
        }
    </script>
</body>
</html>

